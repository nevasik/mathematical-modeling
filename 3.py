import random
import math
import matplotlib.pyplot as plt

def simulate_single_turnstile(
        T=60,                # –æ–±—â–µ–µ –≤—Ä–µ–º—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –º–∏–Ω—É—Ç–∞—Ö
        arrivals_min=0,      # –º–∏–Ω–∏–º—É–º –ø—Ä–∏—à–µ–¥—à–∏—Ö –∑–∞ 1 –º–∏–Ω—É—Ç—É
        arrivals_max=5,      # –º–∞–∫—Å–∏–º—É–º –ø—Ä–∏—à–µ–¥—à–∏—Ö –∑–∞ 1 –º–∏–Ω—É—Ç—É
        service_rate=1/3.0,  # –ø–∞—Ä–∞–º–µ—Ç—Ä mu –¥–ª—è —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (1/3 => —Å—Ä–µ–¥–Ω–µ–µ 3 –º–∏–Ω)
        seed=None
):
    """
    –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –æ–¥–Ω–æ–∫–∞–Ω–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (—Ç—É—Ä–Ω–∏–∫–µ—Ç) –∑–∞ T –º–∏–Ω—É—Ç.

    –ü–ê–†–ê–ú–ï–¢–†–´:
    T              - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è (–≤ –º–∏–Ω—É—Ç–∞—Ö).
    arrivals_min   - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –≤–Ω–æ–≤—å –ø—Ä–∏—à–µ–¥—à–∏—Ö –ª—é–¥–µ–π –≤ –º–∏–Ω—É—Ç—É.
    arrivals_max   - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –≤–Ω–æ–≤—å –ø—Ä–∏—à–µ–¥—à–∏—Ö –ª—é–¥–µ–π –≤ –º–∏–Ω—É—Ç—É.
    service_rate   - –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (–º—É), –∏—Å–ø. –≤ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏.
                     (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1/3 => –≤ —Å—Ä–µ–¥–Ω–µ–º 3 –º–∏–Ω—É—Ç—ã –Ω–∞ –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞)
    seed           - –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª (–¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

    –í–û–ó–í–†–ê–©–ê–ï–¢:
    —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏:
      - time_points        (—Å–ø–∏—Å–æ–∫ –º–∏–Ω—É—Ç [0..T-1]),
      - queue_length       (–¥–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ –∫–æ–Ω–µ—Ü –∫–∞–∂–¥–æ–π –º–∏–Ω—É—Ç—ã),
      - waiting_times      (—Å–ø–∏—Å–æ–∫ –≤—Ä–µ–º–µ–Ω –æ–∂–∏–¥–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –æ–±—Å–ª—É–∂–µ–Ω–Ω—ã—Ö),
      - server_busy_flag   (1 –∏–ª–∏ 0 –≤ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É, –∑–∞–Ω—è—Ç —Ç—É—Ä–Ω–∏–∫–µ—Ç –∏–ª–∏ –Ω–µ—Ç).
    """
    if seed is not None:
        random.seed(seed)

    time_points = list(range(T))
    queue_length = []      # –¥–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ –∫–æ–Ω–µ—Ü –∫–∞–∂–¥–æ–π –º–∏–Ω—É—Ç—ã
    waiting_times = []     # –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –æ–±—Å–ª—É–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
    server_busy_flag = []  # —Å–ø–∏—Å–æ–∫ (0/1) - –∑–∞–Ω—è—Ç –ª–∏ —Å–µ—Ä–≤–µ—Ä –≤ –∫–æ–Ω—Ü–µ –∫–∞–∂–¥–æ–π –º–∏–Ω—É—Ç—ã

    # –û—á–µ—Ä–µ–¥—å: –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –≤ –Ω–µ–π –∫–æ—Ä—Ç–µ–∂–∏ (time_of_arrival)
    queue = []

    # –°–∫–æ–ª—å–∫–æ –µ—â—ë –º–∏–Ω—É—Ç (–≤ –¥—Ä–æ–±–Ω–æ–º –≤–∏–¥–µ) —Ç—É—Ä–Ω–∏–∫–µ—Ç –±—É–¥–µ—Ç –∑–∞–Ω—è—Ç (–æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞)
    server_busy_time = 0.0

    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫, —á—Ç–æ–±—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å "–º–æ–º–µ–Ω—Ç –Ω–∞—á–∞–ª–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è"
    # –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–º, –∫–æ–≥–¥–∞ –æ–Ω —Ä–µ–∞–ª—å–Ω–æ –Ω–∞—á–∞–ª –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å—Å—è (T_start).
    # –¢–æ–≥–¥–∞ W = T_start - T_arrive.

    # –î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É:
    # 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º arrivals
    # 2. –ü—Ä–æ–±—É–µ–º "–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—å" –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –Ω–∞ 1 –º–∏–Ω—É—Ç—É
    # 3. –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –æ—Å–≤–æ–±–æ–¥–∏–ª—Å—è –≤ —ç—Ç–æ–π –º–∏–Ω—É—Ç–µ, –≤–∑—è—Ç—å –∏–∑ –æ—á–µ—Ä–µ–¥–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ (–µ—Å–ª–∏ –µ—Å—Ç—å)

    for minute in time_points:
        # --- 1) –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –ø—Ä–∏—à–µ–¥—à–∏—Ö –ª—é–¥–µ–π ---
        arrivals_num = random.randint(arrivals_min, arrivals_max)  # —á–∏—Å–ª–æ –ø—Ä–∏—à–µ–¥—à–∏—Ö
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∏—Ö –≤—Ä–µ–º—è –ø—Ä–∏—Ö–æ–¥–∞ (minute)
        for _ in range(arrivals_num):
            queue.append(minute)

        # --- 2) –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ ---
        if server_busy_time > 0:
            # —Å–µ—Ä–≤–µ—Ä –∑–∞–Ω—è—Ç, —É–º–µ–Ω—å—à–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ 1 –º–∏–Ω—É—Ç—É
            server_busy_time -= 1.0
            if server_busy_time < 0:
                server_busy_time = 0
        else:
            # —Å–µ—Ä–≤–µ—Ä —Å–≤–æ–±–æ–¥–µ–Ω, –±–µ—Ä–µ–º –Ω–æ–≤–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
            if len(queue) > 0:
                # –≤–æ–∑—å–º—ë–º –ø–µ—Ä–≤–æ–≥–æ (FIFO)
                arrival_time = queue.pop(0)
                # –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è = —Ç–µ–∫—É—â–∞—è –º–∏–Ω—É—Ç–∞
                start_service_time = minute
                # –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
                wait = start_service_time - arrival_time
                waiting_times.append(wait)

                # —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Ä–µ–º—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ)
                # service_rate = mu
                # –µ—Å–ª–∏ X ~ Exp(mu), —Å—Ä–µ–¥–Ω–µ–µ = 1/mu
                # –º–µ—Ç–æ–¥ –æ–±—Ä–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:
                r = random.random()
                service_duration = -math.log(r) / service_rate  # –≤ –º–∏–Ω—É—Ç–∞—Ö

                # —Ç.–∫. –º—ã –º–æ–¥–µ–ª–∏—Ä—É–µ–º –ø–æ–∫–∞–¥—Ä–æ–≤–æ (–ø–æ 1 –º–∏–Ω—É—Ç–µ), –º—ã —Ñ–∏–∫—Å–∏—Ä—É–µ–º
                # —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –µ—â–µ service_duration-1 –∑–∞–Ω—è—Ç—ã–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ.
                server_busy_time = service_duration  # –∫–æ–ª-–≤–æ –º–∏–Ω—É—Ç

        # –ó–∞–ø–∏—Å—å —Ç–µ–∫—É—â–µ–π –¥–ª–∏–Ω—ã –æ—á–µ—Ä–µ–¥–∏ –∏ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
        queue_length.append(len(queue))
        # –§–ª–∞–≥ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
        if server_busy_time > 0:
            server_busy_flag.append(1)
        else:
            server_busy_flag.append(0)

    results = {
        "time_points": time_points,
        "queue_length": queue_length,
        "waiting_times": waiting_times,
        "server_busy": server_busy_flag
    }
    return results


# --- –ó–∞–ø—É—Å–∫ –∏–º–∏—Ç–∞—Ü–∏–∏ ---
res = simulate_single_turnstile(
    T=60,             # 60 –º–∏–Ω—É—Ç
    arrivals_min=0,   # 0..5 —á–µ–ª–æ–≤–µ–∫ –≤ –º–∏–Ω—É—Ç—É
    arrivals_max=5,
    service_rate=1/3, # —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è ~ 3 –º–∏–Ω
    seed=42           # —á—Ç–æ–±—ã –ø—Ä–∏–º–µ—Ä –±—ã–ª –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º
)

time_points = res["time_points"]
queue_length = res["queue_length"]
waiting_times = res["waiting_times"]
server_busy = res["server_busy"]

# --- –ü–û–°–¢–†–û–ï–ù–ò–ï –ì–†–ê–§–ò–ö–û–í ---
plt.figure(figsize=(12,6))

# –ì—Ä–∞—Ñ–∏–∫ 1: –î–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
plt.subplot(2,2,1)
plt.plot(time_points, queue_length, marker='o', label='–î–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏')
plt.xlabel("–í—Ä–µ–º—è (–º–∏–Ω)")
plt.ylabel("–ß–∏—Å–ª–æ –ª—é–¥–µ–π –≤ –æ—á–µ—Ä–µ–¥–∏")
plt.title("–î–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏")
plt.grid(True)
plt.legend()

# –ì—Ä–∞—Ñ–∏–∫ 2: –°–µ—Ä–≤–µ—Ä (—Ç—É—Ä–Ω–∏–∫–µ—Ç) –∑–∞–Ω—è—Ç –∏–ª–∏ –Ω–µ—Ç
plt.subplot(2,2,2)
plt.plot(time_points, server_busy, drawstyle='steps-post', color='orange', label='–ó–∞–Ω—è—Ç(1) / —Å–≤–æ–±–æ–¥–µ–Ω(0)')
plt.ylim(-0.1, 1.1)
plt.xlabel("–í—Ä–µ–º—è (–º–∏–Ω)")
plt.ylabel("–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞")
plt.title("–ó–∞–Ω—è—Ç–æ—Å—Ç—å —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏")
plt.grid(True)
plt.legend()

# –ì—Ä–∞—Ñ–∏–∫ 3: –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –≤—Ä–µ–º—ë–Ω –æ–∂–∏–¥–∞–Ω–∏—è
plt.subplot(2,2,3)
plt.hist(waiting_times, bins=20, edgecolor='black', alpha=0.7)
plt.xlabel("–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (–º–∏–Ω)")
plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
plt.title("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è")
plt.grid(True)

# –ì—Ä–∞—Ñ–∏–∫ 4: –≠–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ waiting_times (CDF)
sorted_waits = sorted(waiting_times)
cdf_y = [(i+1)/len(sorted_waits) for i in range(len(sorted_waits))]
plt.subplot(2,2,4)
plt.plot(sorted_waits, cdf_y, marker='.')
plt.xlabel("–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (–º–∏–Ω)")
plt.ylabel("F(w)")
plt.title("–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (CDF)")
plt.grid(True)

plt.tight_layout()
plt.show()

# –ü–µ—á–∞—Ç–∞–µ–º –ø—Ä–æ—Å—Ç—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
print(f"–°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏: {sum(queue_length)/len(queue_length):.2f}")
print(f"–ú–∞–∫—Å. –¥–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏: {max(queue_length)}")
if waiting_times:
    print(f"–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è: {sum(waiting_times)/len(waiting_times):.2f} –º–∏–Ω")
    print(f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è: {max(waiting_times):.2f} –º–∏–Ω")
    print(f"–û–±—Å–ª—É–∂–µ–Ω–æ –ª—é–¥–µ–π: {len(waiting_times)}")
else:
    print("–ù–∏–∫—Ç–æ –Ω–µ –±—ã–ª –æ–±—Å–ª—É–∂–µ–Ω (–Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è).")

server_utilization = sum(server_busy)/len(server_busy)  # –¥–æ–ª—è –º–∏–Ω—É—Ç, –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –±—ã–ª –∑–∞–Ω—è—Ç
print(f"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞ (–¥–æ–ª—è –∑–∞–Ω—è—Ç–æ—Å—Ç–∏): {server_utilization*100:.1f}%")


# –§—É–Ω–∫—Ü–∏—è simulate_single_turnstile. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
# T ‚Äî –æ–±—â–µ–µ –≤—Ä–µ–º—è (–º–∏–Ω—É—Ç—ã),
# arrivals_min, arrivals_max ‚Äî –ø—Ä–µ–¥–µ–ª—ã ¬´—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–π¬ª –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ª—é–¥–µ–π –≤ –º–∏–Ω—É—Ç—É,
# service_rate ‚Äî ùúá, –ø–∞—Ä–∞–º–µ—Ç—Ä —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (—Å—Ä–µ–¥–Ω–µ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ = 1/Œº –º–∏–Ω—É—Ç),
# seed ‚Äî –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏.

# –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ minute (–æ—Ç 0 –¥–æ T-1) –º—ã:
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º arrivals_num = randint(min, max).
# –î–æ–±–∞–≤–ª—è–µ–º —ç—Ç–∏—Ö –ª—é–¥–µ–π –≤ –æ—á–µ—Ä–µ–¥—å (–∑–∞–ø–æ–º–∏–Ω–∞—è –∏—Ö –≤—Ä–µ–º—è –ø—Ä–∏—Ö–æ–¥–∞ = minute).
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–Ω—è—Ç –ª–∏ —Ç—É—Ä–Ω–∏–∫–µ—Ç (server_busy_time > 0). –ï—Å–ª–∏ –∑–∞–Ω—è—Ç, —É–º–µ–Ω—å—à–∞–µ–º server_busy_time –Ω–∞ 1 –º–∏–Ω—É—Ç—É.–ï—Å–ª–∏ —Å–≤–æ–±–æ–¥–µ–Ω‚Äì–±–µ—Ä—ë–º –ø–µ—Ä–≤–æ–≥–æ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ (–µ—Å–ª–∏ —Ç–∞–º –µ—Å—Ç—å) –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–ª—è –Ω–µ–≥–æ –≤—Ä–µ–º—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ).
# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–ª–∏–Ω—É –æ—á–µ—Ä–µ–¥–∏, –∑–∞–Ω—è—Ç–æ—Å—Ç—å —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞ –∏ –∏–¥—ë–º –¥–∞–ª—å—à–µ.

# –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
# queue_length ‚Äî —Å–ø–∏—Å–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –º–∏–Ω—É—Ç—ã –∑–∞–ø–∏—Å–∞–Ω–∞ –¥–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏.
# waiting_times ‚Äî –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞ –æ–∂–∏–¥–∞–Ω–∏—è (—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç —Å—Ç—É–¥–µ–Ω—Ç –∂–¥–∞–ª –≤ –æ—á–µ—Ä–µ–¥–∏).
# server_busy ‚Äî 1 –∏–ª–∏ 0 –¥–ª—è –∫–∞–∂–¥–æ–π –º–∏–Ω—É—Ç—ã (—Ç—É—Ä–Ω–∏–∫–µ—Ç –∑–∞–Ω—è—Ç –∏–ª–∏ –Ω–µ—Ç). –ü–æ –Ω–µ–º—É –¥–∞–ª—å—à–µ —Å—á–∏—Ç–∞–µ–º –¥–æ–ª—é –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ (–∑–∞–≥—Ä—É–∑–∫—É).

# –ì—Ä–∞—Ñ–∏–∫–∏:
# –ü–µ—Ä–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏–∫—É –æ—á–µ—Ä–µ–¥–∏ (—Å–∫–æ–ª—å–∫–æ –ª—é–¥–µ–π —Å—Ç–æ–∏—Ç, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è/—É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ª–∏ –æ—á–µ—Ä–µ–¥—å).
# –í—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ —Ç—É—Ä–Ω–∏–∫–µ—Ç –∑–∞–Ω—è—Ç (1) –∏ –∫–æ–≥–¥–∞ –æ–Ω —Å–≤–æ–±–æ–¥–µ–Ω (0).
# –¢—Ä–µ—Ç—å—è ‚Äî –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –≤—Ä–µ–º–µ–Ω –æ–∂–∏–¥–∞–Ω–∏—è.
# –ß–µ—Ç–≤—ë—Ä—Ç–∞—è ‚Äî CDF (–Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è) –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å, –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ–∂–∏–¥–∞–ª –º–µ–Ω—å—à–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

# –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
# –°—Ä–µ–¥–Ω—è—è –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏,
# –°—Ä–µ–¥–Ω–µ–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è,
# –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞ ‚Äî –¥–æ–ª—è –º–∏–Ω—É—Ç, –∫–æ–≥–¥–∞ –æ–Ω –±—ã–ª –∑–∞–Ω—è—Ç.